<!doctype html>
<html lang="en">

<head>
        <title>ESP32 Lire DHT11 C++ - Cybersécurité, Informatique et Réseaux, Électronique - Thomas Edison</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        
        
        

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="../assets/css/darcula-highlight.min.css">

        <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
        <link rel="stylesheet" href="../assets/css/dracula-ui.min.css">
        <link rel="stylesheet" href="../assets/css/mkdocs.min.css">

        
            <link  rel="icon" type="image/x-icon" href="../assets/img/favicon.ico">
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
                <script>hljs.initHighlightingOnLoad();</script>

</head>

<body class="drac-bg-black-secondary drac-text-grey-ternary drac-text drac-scrollbar-purple">

    <main class="d-flex">

        <!-- block sidebar -->
            <nav id="sidebar" class="sidebar drac-bg-black">
    <div class="custom-menu">
        <button type="button" id="sidebarCollapse" class="btn btn-primary">
            <i class="fa fa-bars"></i>
            <span class="sr-only">Menu</span>
        </button>
    </div>

    <div class="p-4">
        

        <div class="drac-text-center">
            
                <span class="drac-text drac-line-height drac-text-white">Cybersécurité, Informatique et Réseaux, Électronique - Thomas Edison</span>
            
        </div>

        <div class="drac-box flex-column">
            <ul class="dot-ul">
                <li><div class="dot-li drac-bg-cyan"></div></li>
                <li><div class="dot-li drac-bg-green"></div></li>
                <li><div class="dot-li drac-bg-orange"></div></li>
                <li><div class="dot-li drac-bg-pink"></div></li>
                <li><div class="dot-li drac-bg-purple"></div></li>
                <li><div class="dot-li drac-bg-red"></div></li>
                <li><div class="dot-li drac-bg-yellow"></div></li>
            </ul>
        </div>

        <hr class="drac-divider" />

        <!-- block menu -->
        <ul class="mb-5 drac-list drac-list-none">
            
            <li class="drac-box">
                <a href=".."
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Home
                </a>
            </li>
            <li class="drac-box">
                <a href="../programmation1/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Programmation 1
                </a>
            </li>
            <li class="drac-box">
                <a href="../reconditionnement/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Reconditionnement PC
                </a>
            </li>
            <li class="drac-box">
                <a href="../infranetwork/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Infrastructure Réseau
                </a>
            </li>
            <li class="drac-box">
                <a href="../eval_infranetwork/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Evaluation Infrastructure Réseau
                </a>
            </li>
            <li class="drac-box">
                <a href="../tinkerCAD/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    TinkerCAD
                </a>
            </li>
            <li class="drac-box">
                <a href="../proxmox/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Proxmox
                </a>
            </li>
            <li class="drac-box">
                <a href="../admin_server/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Admin Server
                </a>
            </li>
            <li class="drac-box">
                <a href="../linux/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Linux
                </a>
            </li>
            <li class="drac-box">
                <a href="../euro/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Section Euro
                </a>
            </li>
            <li class="drac-box">
                <a href="../adresseip/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Adresse IP
                </a>
            </li>
            <li class="drac-box">
                <a href="../esp/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Carte ESP32/ESP8622
                </a>
            </li>
            <li class="drac-box">
                <a href="../arduino/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Carte Arduino
                </a>
            </li>
            <li class="drac-box">
                <a href="../ide-arduino/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    IDE Arduino
                </a>
            </li>
            <li class="drac-box">
                <a href="../micropython/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    IDE MicroPython
                </a>
            </li>
            <li class="drac-box">
                <a href="../micropython-webserver/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    ESP32 GPIO Python Webserver
                </a>
            </li>
            <li class="drac-box">
                <a href="../read_temp_dht11_python/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    ESP32 Lire DHT11 Python
                </a>
            </li>
            <li class="drac-box">
                <a href="./"
                    class=" active 
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    ESP32 Lire DHT11 C++
                </a>
            </li>
            <li class="drac-box">
                <a href="../esp_mqtt_nodered/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    ESP, MQTT, Node-RED
                </a>
            </li>
            <li class="drac-box">
                <a href="../raspberrypi/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Raspberry Pi
                </a>
            </li>
            <li class="drac-box">
                <a href="../ipphone/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Téléphonie IP
                </a>
            </li>
            <li class="drac-box">
                <a href="../reseau/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Réseau
                </a>
            </li>
            <li class="drac-box">
                <a href="../cordonrj45/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Cordon RJ45
                </a>
            </li>
            <li class="drac-box">
                <a href="../esp32_server/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    ESP32 Server
                </a>
            </li>
            <li class="drac-box">
                <a href="../esp32_sk6812/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    ESP32 LED SK6812
                </a>
            </li>
            <li class="drac-box">
                <a href="../esp32_ws2812B/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    ESP32 LED WS2812B
                </a>
            </li>
        </ul>
        <!-- endblock -->
    </div>
</nav>
        <!-- endblock -->

        <nav class="divider drac-bg-purple-cyan"></nav>

        <div class="content">
            <!-- block header -->
                <header>
    <nav class="navbar navbar-expand-xl drac-bg-purple">
        <div class="container-fluid">
            
            <button class="navbar-toggler w-100 text-center" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsMenu"
                aria-controls="navbarsMenu" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse flex-column ml-auto" id="navbarsMenu">
                <ul class="navbar-nav text-md-center">

                    <!-- block preview -->
                    <li class="nav-item">
                            
        <div class="container">
            <div class="row row-preview">
                <div class="col">
                    <a href="../read_temp_dht11_python/"
                        class="btn-preview drac-btn drac-btn-outline drac-text-white drac-text-cyan-green--hover">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </div>
                <div class="col">
                    <a href="../esp_mqtt_nodered/"
                        class="btn-preview drac-btn drac-btn-outline drac-text-white drac-text-cyan-green--hover" style="padding-left: 3%;">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </div>
            </div>
        </div>
                    </li>
                    <!--  endblock -->

                    <!-- block search -->
                    <li class="nav-item">
                    </li>
                    <!--  endblock -->

                    <!-- block source -->
                    <li class="nav-item">
                        
                    </li>
                    <!--  endblock -->

                </ul>
            </div>

        </div>
    </nav>
</header>
            <!-- endblock -->

            <!-- block content -->
                <section class="p-md-5 section-content">
    <article>
        <p><div><h1 id="utilisation-de-arduino-ide-c-esp32-et-un-capteur-dht11">Utilisation de Arduino IDE, C++, ESP32 et un capteur DHT11</h1>
<p><img src="/img/capteur-de-temperature-dht11.jpg" alt="image" width="50%" height="auto"></p>
<p>Prérequis :  </p>
<ul>
<li>firmware ESP32 flashé avec le firmware Arduino IDE   </li>
</ul>
<h2 id="lecture-simple-du-capteur">Lecture simple du capteur</h2>
<p><em>source : https://www.upesy.fr/blogs/tutorials/dht11-humidity-temperature-sensor-with-arduino-code-on-esp32-board</em>  </p>
<p>Le capteur DHT11 est très populaire parmi les makers et les adeptes du DIY. Il est, en effet, si prisé qu’il est inclus par défaut dans MicroPython. Son prix avantageux et sa simplicité d’utilisation en sont les principales raisons.</p>
<h3 id="correspondance-des-broches">Correspondance des broches :</h3>
<table>
<thead>
<tr>
<th style="text-align: center;">Module DHT11</th>
<th style="text-align: center;">ESP32</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">1 - GND</td>
<td style="text-align: center;">GND</td>
</tr>
<tr>
<td style="text-align: center;">2 - DATA</td>
<td style="text-align: center;">GPIO 17</td>
</tr>
<tr>
<td style="text-align: center;">3 - Vcc</td>
<td style="text-align: center;">3,3V</td>
</tr>
</tbody>
</table>
<p><em>Attention : Selon votre ESP32, la GPIO 17 n'est pas placée au même endroit.
ESP32.</em><br>
<em>Attention : Si le module ne comporte pas de résistance de pullup, il faut en ajouter une entre 4.7kΩ (ou 10kΩ) entre les broches 3V3 et le signal (GPIO17 ).</em> <br>
<em>Attention : Vérifier que vous alimentez bien le module en 3.3V et non 5V pour avoir un signal de données de 3.3V également.</em></p>
<h3 id="mesurer-la-temperature-et-lhumidite-ambiante-du-dht11">Mesurer la température et l’humidité ambiante du DHT11</h3>
<p>Puisque le DHT11 utilise un protocole propriétaire, il est indispensable d’utiliser une librairie pour communiquer facilement avec le capteur. Je vous conseille d’utiliser la librairie DHT Sensor d’Adafruit qui fonctionne correctement sur l’ESP32 .</p>
<p>Dans le gestionnaire de bibliothèque (Library Manager), rechercher et installer (Install ALL) " DHT sensor library " de Adafruit.</p>
<p>Une fois que la librairie est installée on utilise le code suivant qui récupère la température et le taux d’humidité du DHT11.</p>
<pre><code>#include "DHT.h"

#define DHTPIN 17
#define DHTTYPE DHT11
//DHTTYPE = DHT11, mais il existe aussi le DHT22 et 21

DHT dht(DHTPIN, DHTTYPE); // constructeur pour déclarer notre capteur

void setup() {
  Serial.begin(115200);
  dht.begin();
}

void loop() {
  delay(1000);
  // Le DHT11 renvoie au maximum une mesure toute les 1s
  float h = dht.readHumidity();
  //Lis le taux d'humidite en %
  float t = dht.readTemperature();
  //Lis la température en degré celsius

  Serial.print("Humidite: ");
  Serial.print(h);
  Serial.print("%  Temperature: ");
  Serial.print(t);
  Serial.println("°C, ");
  // Transmet les mesures reçues dans le moniteur série
}

</code></pre>
<p>Retour dans la console/monitor  </p>
<pre><code>Humidite: 49.00%  Temperature: 23.00°C, 73.40°F
Humidite: 49.00%  Temperature: 23.00°C, 73.40°F
Humidite: 49.00%  Temperature: 23.00°C, 73.40°F
Humidite: 49.00%  Temperature: 23.00°C, 73.40°F
</code></pre>
<h2 id="lecture-du-capteur-et-envoie-sur-une-page-web">Lecture du capteur et envoie sur une page web</h2>
<p><em>source : https://randomnerdtutorials.com/esp32-dht11-dht22-temperature-humidity-web-server-arduino-ide/</em>  </p>
<pre><code>#include &lt;WiFi.h&gt;
#include &lt;WebServer.h&gt;
#include "DHT.h"

#define DHTTYPE DHT11 // DHT 11

/*Put your SSID &amp; Password*/
const char* ssid = "YourNetworkName";  // Enter SSID here
const char* password = "YourPassword";  //Enter Password here

WebServer server(80);

// DHT Sensor
uint8_t DHTPin = 17; 

// Initialize DHT sensor.
DHT dht(DHTPin, DHTTYPE);                

float Temperature;
float Humidity;

void setup() {
  Serial.begin(115200);
  delay(100);

  pinMode(DHTPin, INPUT);

  dht.begin();              

  Serial.println("Connecting to ");
  Serial.println(ssid);

  //connect to your local wi-fi network
  WiFi.begin(ssid, password);

  //check wi-fi is connected to wi-fi network
  while (WiFi.status() != WL_CONNECTED) {
  delay(1000);
  Serial.print(".");
  }
  Serial.println("");
  Serial.println("WiFi connected..!");
  Serial.print("Got IP: ");  Serial.println(WiFi.localIP());

  server.on("/", handle_OnConnect);
  server.onNotFound(handle_NotFound);

  server.begin();
  Serial.println("HTTP server started");

}
void loop() {

  server.handleClient();

}

void handle_OnConnect() {

  Temperature = dht.readTemperature(); // Gets the values of the temperature
  Humidity = dht.readHumidity(); // Gets the values of the humidity 
  server.send(200, "text/html", SendHTML(Temperature,Humidity)); 
}

void handle_NotFound(){
  server.send(404, "text/plain", "Not found");
}

String SendHTML(float Temperaturestat,float Humiditystat){
  String ptr = "&lt;!DOCTYPE html&gt; &lt;html&gt;\n";
  ptr +="&lt;head&gt;\n";
  ptr +="&lt;title&gt;ESP32 Weather Report&lt;/title&gt;\n";
  ptr +="&lt;/head&gt;\n";
  ptr +="&lt;body&gt;\n";
  ptr +="&lt;h1&gt;ESP32 Weather Report&lt;/h1&gt;\n";
  ptr +="&lt;p&gt;Temperature: ";
  ptr +=(int)Temperaturestat;
  ptr +="&amp;deg;C&lt;/p&gt;";
  ptr +="&lt;p&gt;Humidity: ";
  ptr +=(int)Humiditystat;
  ptr +="%&lt;/p&gt;";
  ptr +="&lt;/body&gt;\n";
  ptr +="&lt;/html&gt;\n";
  return ptr;
}

</code></pre></div></p>
    </article>
</section>
            <!-- endblock -->

            <!-- block footer -->
                <footer>
    <div class="d-flex flex-sm-row justify-content-between py-2 border-top drac-text-black drac-bg-cyan-green">
        <a href="https://github.com/dracula/mkdocs" target="_blank" style="padding-left: 1%;"
            class="footer-text drac-anchor drac-text-black drac-text-purple--hover">
            Made with Dracula Theme for MkDocs
        </a>
    </div>
</footer>
            <!-- endblock -->
        </div>

    </main>

        <script>var base_url = '..';</script>
        <script src="../assets/js/jquery-3.3.1.slim.min.js"></script>
        <script src="../assets/js/bootstrap.bundle.min.js"></script>
        <script src="../assets/js/mkdocs.js"></script>

</body>

</html>