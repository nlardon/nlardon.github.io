<!doctype html>
<html lang="en">

<head>
        <title>ESP32 Server - Cybersécurité, Informatique et Réseaux, Électronique - Thomas Edison</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        
        
        

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="../assets/css/darcula-highlight.min.css">

        <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
        <link rel="stylesheet" href="../assets/css/dracula-ui.min.css">
        <link rel="stylesheet" href="../assets/css/mkdocs.min.css">

        
            <link  rel="icon" type="image/x-icon" href="../assets/img/favicon.ico">
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
                <script>hljs.initHighlightingOnLoad();</script>

</head>

<body class="drac-bg-black-secondary drac-text-grey-ternary drac-text drac-scrollbar-purple">

    <main class="d-flex">

        <!-- block sidebar -->
            <nav id="sidebar" class="sidebar drac-bg-black">
    <div class="custom-menu">
        <button type="button" id="sidebarCollapse" class="btn btn-primary">
            <i class="fa fa-bars"></i>
            <span class="sr-only">Menu</span>
        </button>
    </div>

    <div class="p-4">
        

        <div class="drac-text-center">
            
                <span class="drac-text drac-line-height drac-text-white">Cybersécurité, Informatique et Réseaux, Électronique - Thomas Edison</span>
            
        </div>

        <div class="drac-box flex-column">
            <ul class="dot-ul">
                <li><div class="dot-li drac-bg-cyan"></div></li>
                <li><div class="dot-li drac-bg-green"></div></li>
                <li><div class="dot-li drac-bg-orange"></div></li>
                <li><div class="dot-li drac-bg-pink"></div></li>
                <li><div class="dot-li drac-bg-purple"></div></li>
                <li><div class="dot-li drac-bg-red"></div></li>
                <li><div class="dot-li drac-bg-yellow"></div></li>
            </ul>
        </div>

        <hr class="drac-divider" />

        <!-- block menu -->
        <ul class="mb-5 drac-list drac-list-none">
            
            <li class="drac-box">
                <a href=".."
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Home
                </a>
            </li>
            <li class="drac-box">
                <a href="../programmation1/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Programmation 1
                </a>
            </li>
            <li class="drac-box">
                <a href="../reconditionnement/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Reconditionnement PC
                </a>
            </li>
            <li class="drac-box">
                <a href="../infranetwork/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Infrastructure Réseau
                </a>
            </li>
            <li class="drac-box">
                <a href="../tinkerCAD/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    TinkerCAD
                </a>
            </li>
            <li class="drac-box">
                <a href="../proxmox/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Proxmox
                </a>
            </li>
            <li class="drac-box">
                <a href="../admin_server/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Admin Server
                </a>
            </li>
            <li class="drac-box">
                <a href="../linux/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Linux
                </a>
            </li>
            <li class="drac-box">
                <a href="../euro/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Section Euro
                </a>
            </li>
            <li class="drac-box">
                <a href="../adresseip/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Adresse IP
                </a>
            </li>
            <li class="drac-box">
                <a href="../esp/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Carte ESP32/ESP8622
                </a>
            </li>
            <li class="drac-box">
                <a href="../arduino/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Carte Arduino
                </a>
            </li>
            <li class="drac-box">
                <a href="../ide-arduino/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    IDE Arduino
                </a>
            </li>
            <li class="drac-box">
                <a href="../micropython/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    IDE MicroPython
                </a>
            </li>
            <li class="drac-box">
                <a href="../micropython-webserver/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    ESP32 GPIO Python Webserver
                </a>
            </li>
            <li class="drac-box">
                <a href="../read_temp_dht11_python/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    ESP32 Lire DHT11 Python
                </a>
            </li>
            <li class="drac-box">
                <a href="../read_temp_dht11_c/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    ESP32 Lire DHT11 C++
                </a>
            </li>
            <li class="drac-box">
                <a href="../esp_mqtt_nodered/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    ESP, MQTT, Node-RED
                </a>
            </li>
            <li class="drac-box">
                <a href="../raspberrypi/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Raspberry Pi
                </a>
            </li>
            <li class="drac-box">
                <a href="../ipphone/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Téléphonie IP
                </a>
            </li>
            <li class="drac-box">
                <a href="../reseau/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Réseau
                </a>
            </li>
            <li class="drac-box">
                <a href="../cordonrj45/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Cordon RJ45
                </a>
            </li>
            <li class="drac-box">
                <a href="./"
                    class=" active 
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    ESP32 Server
                </a>
            </li>
            <li class="drac-box">
                <a href="../esp32_sk6812/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    ESP32 LED SK6812
                </a>
            </li>
            <li class="drac-box">
                <a href="../esp32_ws2812B/"
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    ESP32 LED WS2812B
                </a>
            </li>
        </ul>
        <!-- endblock -->
    </div>
</nav>
        <!-- endblock -->

        <nav class="divider drac-bg-purple-cyan"></nav>

        <div class="content">
            <!-- block header -->
                <header>
    <nav class="navbar navbar-expand-xl drac-bg-purple">
        <div class="container-fluid">
            
            <button class="navbar-toggler w-100 text-center" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsMenu"
                aria-controls="navbarsMenu" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse flex-column ml-auto" id="navbarsMenu">
                <ul class="navbar-nav text-md-center">

                    <!-- block preview -->
                    <li class="nav-item">
                            
        <div class="container">
            <div class="row row-preview">
                <div class="col">
                    <a href="../cordonrj45/"
                        class="btn-preview drac-btn drac-btn-outline drac-text-white drac-text-cyan-green--hover">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </div>
                <div class="col">
                    <a href="../esp32_sk6812/"
                        class="btn-preview drac-btn drac-btn-outline drac-text-white drac-text-cyan-green--hover" style="padding-left: 3%;">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </div>
            </div>
        </div>
                    </li>
                    <!--  endblock -->

                    <!-- block search -->
                    <li class="nav-item">
                    </li>
                    <!--  endblock -->

                    <!-- block source -->
                    <li class="nav-item">
                        
                    </li>
                    <!--  endblock -->

                </ul>
            </div>

        </div>
    </nav>
</header>
            <!-- endblock -->

            <!-- block content -->
                <section class="p-md-5 section-content">
    <article>
        <p><div><h1 id="esp32-web-server">ESP32 Web Server</h1>
<p><img alt="" src="../img/esp32server/esp32-we-server.webp"></p>
<p><em>source : randomnerdtutorials.com/esp32-web-server-arduino-ide/</em>  </p>
<p>In this project you’ll create a standalone web server with an ESP32 that controls outputs (two LEDs) using the Arduino IDE programming environment. The web server is mobile responsive and can be accessed with any device that as a browser on the local network. We’ll show you how to create the web server and how the code works step-by-step.</p>
<h2 id="watch-the-video-tutorial">Watch the Video Tutorial</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/ApGwxX6VVzk?si=vIXXsLms5zQ3lZ0W" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

<h2 id="project-overview">Project Overview</h2>
<p>Before going straight to the project, it is important to outline what our web server will do, so that it is easier to follow the steps later on.  </p>
<p>The web server you’ll build controls two LEDs connected to the ESP32 GPIO 26 and GPIO 27;<br>
You can access the ESP32 web server by typing the ESP32 IP address on a browser in the local network;<br>
By clicking the buttons on your web server you can instantly change the state of each LED.<br>
This is just a simple example to illustrate how to build a web server that controls outputs, the idea is to replace those LEDs with a relay, or any other electronic components you want.  </p>
<h2 id="parts-required">Parts Required</h2>
<p>For this tutorial you’ll need the following parts:</p>
<p><img alt="" src="../img/esp32server/esp32-web-server-arduino-ide-parts-required.webp"></p>
<ul>
<li>ESP32 development board  </li>
<li>2x 5mm LED</li>
<li>2x 330 Ohm resistor</li>
<li>Breadboard</li>
<li>Jumper wires</li>
</ul>
<h2 id="schematic">Schematic</h2>
<p>Start by building the circuit.<br>
Connect two LEDs to the ESP32 as shown in the following schematic diagram – one LED connected to GPIO 26, and the other to GPIO 27.  </p>
<p><img alt="" src="../img/esp32server/esp32_web_server_schematic.webp"></p>
<h2 id="esp32-web-server-code">ESP32 Web Server Code</h2>
<p>Here we provide the code that creates the ESP32 web server. Copy the following code to your Arduino IDE, but don’t upload it yet. You need to make some changes to make it work for you.</p>
<p>Programme test :</p>
<pre><code class="language-arduino">/*********
  Rui Santos
  Complete project details at http://randomnerdtutorials.com  
*********/

// Load Wi-Fi library
#include &lt;WiFi.h&gt;

// Replace with your network credentials
const char* ssid = "REPLACE_WITH_YOUR_SSID";
const char* password = "REPLACE_WITH_YOUR_PASSWORD";

// Set web server port number to 80
WiFiServer server(80);

// Variable to store the HTTP request
String header;

// Auxiliar variables to store the current output state
String output26State = "off";
String output27State = "off";

// Assign output variables to GPIO pins
const int output26 = 26;
const int output27 = 27;

// Current time
unsigned long currentTime = millis();
// Previous time
unsigned long previousTime = 0; 
// Define timeout time in milliseconds (example: 2000ms = 2s)
const long timeoutTime = 2000;

void setup() {
  Serial.begin(115200);
  // Initialize the output variables as outputs
  pinMode(output26, OUTPUT);
  pinMode(output27, OUTPUT);
  // Set outputs to LOW
  digitalWrite(output26, LOW);
  digitalWrite(output27, LOW);

  // Connect to Wi-Fi network with SSID and password
  Serial.print("Connecting to ");
  Serial.println(ssid);
  WiFi.begin(ssid, password);
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  // Print local IP address and start web server
  Serial.println("");
  Serial.println("WiFi connected.");
  Serial.println("IP address: ");
  Serial.println(WiFi.localIP());
  server.begin();
}

void loop(){
  WiFiClient client = server.available();   // Listen for incoming clients

  if (client) {                             // If a new client connects,
    currentTime = millis();
    previousTime = currentTime;
    Serial.println("New Client.");          // print a message out in the serial port
    String currentLine = "";                // make a String to hold incoming data from the client
    while (client.connected() &amp;&amp; currentTime - previousTime &lt;= timeoutTime) {  // loop while the client's connected
      currentTime = millis();
      if (client.available()) {             // if there's bytes to read from the client,
        char c = client.read();             // read a byte, then
        Serial.write(c);                    // print it out the serial monitor
        header += c;
        if (c == '\n') {                    // if the byte is a newline character
          // if the current line is blank, you got two newline characters in a row.
          // that's the end of the client HTTP request, so send a response:
          if (currentLine.length() == 0) {
            // HTTP headers always start with a response code (e.g. HTTP/1.1 200 OK)
            // and a content-type so the client knows what's coming, then a blank line:
            client.println("HTTP/1.1 200 OK");
            client.println("Content-type:text/html");
            client.println("Connection: close");
            client.println();

            // turns the GPIOs on and off
            if (header.indexOf("GET /26/on") &gt;= 0) {
              Serial.println("GPIO 26 on");
              output26State = "on";
              digitalWrite(output26, HIGH);
            } else if (header.indexOf("GET /26/off") &gt;= 0) {
              Serial.println("GPIO 26 off");
              output26State = "off";
              digitalWrite(output26, LOW);
            } else if (header.indexOf("GET /27/on") &gt;= 0) {
              Serial.println("GPIO 27 on");
              output27State = "on";
              digitalWrite(output27, HIGH);
            } else if (header.indexOf("GET /27/off") &gt;= 0) {
              Serial.println("GPIO 27 off");
              output27State = "off";
              digitalWrite(output27, LOW);
            }

            // Display the HTML web page
            client.println("&lt;!DOCTYPE html&gt;&lt;html&gt;");
            client.println("&lt;head&gt;&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;");
            client.println("&lt;link rel=\"icon\" href=\"data:,\"&gt;");
            // CSS to style the on/off buttons 
            // Feel free to change the background-color and font-size attributes to fit your preferences
            client.println("&lt;style&gt;html { font-family: Helvetica; display: inline-block; margin: 0px auto; text-align: center;}");
            client.println(".button { background-color: #4CAF50; border: none; color: white; padding: 16px 40px;");
            client.println("text-decoration: none; font-size: 30px; margin: 2px; cursor: pointer;}");
            client.println(".button2 {background-color: #555555;}&lt;/style&gt;&lt;/head&gt;");

            // Web Page Heading
            client.println("&lt;body&gt;&lt;h1&gt;ESP32 Web Server&lt;/h1&gt;");

            // Display current state, and ON/OFF buttons for GPIO 26  
            client.println("&lt;p&gt;GPIO 26 - State " + output26State + "&lt;/p&gt;");
            // If the output26State is off, it displays the ON button       
            if (output26State=="off") {
              client.println("&lt;p&gt;&lt;a href=\"/26/on\"&gt;&lt;button class=\"button\"&gt;ON&lt;/button&gt;&lt;/a&gt;&lt;/p&gt;");
            } else {
              client.println("&lt;p&gt;&lt;a href=\"/26/off\"&gt;&lt;button class=\"button button2\"&gt;OFF&lt;/button&gt;&lt;/a&gt;&lt;/p&gt;");
            } 

            // Display current state, and ON/OFF buttons for GPIO 27  
            client.println("&lt;p&gt;GPIO 27 - State " + output27State + "&lt;/p&gt;");
            // If the output27State is off, it displays the ON button       
            if (output27State=="off") {
              client.println("&lt;p&gt;&lt;a href=\"/27/on\"&gt;&lt;button class=\"button\"&gt;ON&lt;/button&gt;&lt;/a&gt;&lt;/p&gt;");
            } else {
              client.println("&lt;p&gt;&lt;a href=\"/27/off\"&gt;&lt;button class=\"button button2\"&gt;OFF&lt;/button&gt;&lt;/a&gt;&lt;/p&gt;");
            }
            client.println("&lt;/body&gt;&lt;/html&gt;");

            // The HTTP response ends with another blank line
            client.println();
            // Break out of the while loop
            break;
          } else { // if you got a newline, then clear currentLine
            currentLine = "";
          }
        } else if (c != '\r') {  // if you got anything else but a carriage return character,
          currentLine += c;      // add it to the end of the currentLine
        }
      }
    }
    // Clear the header variable
    header = "";
    // Close the connection
    client.stop();
    Serial.println("Client disconnected.");
    Serial.println("");
  }
}
</code></pre>
<h2 id="setting-your-network-credentials">Setting Your Network Credentials</h2>
<p>You need to modify the following lines with your network credentials: SSID and password. The code is well commented on where you should make the changes.  </p>
<pre><code class="language-arduino">
// Replace with your network credentials
const char* ssid     = "REPLACE_WITH_YOUR_SSID";
const char* password = "REPLACE_WITH_YOUR_PASSWORD";

</code></pre>
<h2 id="uploading-the-code">Uploading the Code</h2>
<p>Now, you can upload the code and and the web server will work straight away. Follow the next steps to upload code to the ESP32:  </p>
<p>1) Plug your ESP32 board in your computer;  </p>
<p>2) In the Arduino IDE select your board in Tools &gt; Board (in our case we’re using the ESP32 DEV Module);  </p>
<p>3) Select the COM port in Tools &gt; Port.</p>
<p>4) Press the Upload button in the Arduino IDE and wait a few seconds while the code compiles and uploads to your board.</p>
<p>5) Wait for the “Done uploading” message.</p>
<h2 id="finding-the-esp-ip-address">Finding the ESP IP Address</h2>
<p>After uploading the code, open the Serial Monitor at a baud rate of 115200.</p>
<p><img alt="" src="../img/esp32server/serial-monitor.webp"></p>
<p>Press the ESP32 EN button (reset). The ESP32 connects to Wi-Fi, and outputs the ESP IP address on the Serial Monitor. Copy that IP address, because you need it to access the ESP32 web server.</p>
<p><img alt="" src="../img/esp32server/ESP-IP-address-1.webp"></p>
<h2 id="accessing-the-web-server">Accessing the Web Server</h2>
<p>To access the web server, open your browser, paste the ESP32 IP address, and you’ll see the following page. In our case it is 192.168.1.135.</p>
<p><img alt="" src="../img/esp32server/esp32-web-server-outputs.webp"></p>
<p>If you take a look at the Serial Monitor, you can see what’s happening on the background. The ESP receives an HTTP request from a new client (in this case, your browser).</p>
<p><img alt="" src="../img/esp32server/new-client.webp"></p>
<p>You can also see other information about the HTTP request.</p>
<h2 id="testing-the-web-server">Testing the Web Server</h2>
<p>Now you can test if your web server is working properly. Click the buttons to control the LEDs.</p>
<p>At the same time, you can take a look at the Serial Monitor to see what’s going on in the background. For example, when you click the button to turn GPIO 26 ON, ESP32 receives a request on the /26/on URL.  </p>
<p>When the ESP32 receives that request, it turns the LED attached to GPIO 26 ON and updates its state on the web page.  </p>
<p>The button for GPIO 27 works in a similar way. Test that it is working properly.  </p></div></p>
    </article>
</section>
            <!-- endblock -->

            <!-- block footer -->
                <footer>
    <div class="d-flex flex-sm-row justify-content-between py-2 border-top drac-text-black drac-bg-cyan-green">
        <a href="https://github.com/dracula/mkdocs" target="_blank" style="padding-left: 1%;"
            class="footer-text drac-anchor drac-text-black drac-text-purple--hover">
            Made with Dracula Theme for MkDocs
        </a>
    </div>
</footer>
            <!-- endblock -->
        </div>

    </main>

        <script>var base_url = '..';</script>
        <script src="../assets/js/jquery-3.3.1.slim.min.js"></script>
        <script src="../assets/js/bootstrap.bundle.min.js"></script>
        <script src="../assets/js/mkdocs.js"></script>

</body>

</html>